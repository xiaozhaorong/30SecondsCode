00 JMMä¸JVM
--- 
>  Javaæ˜¯è¿è¡Œåœ¨è™šæ‹Ÿæœºä¸Šé¢çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆJavaèƒ½è·¨å¹³å°è¿è¡Œçš„åŸå› ï¼Œä½œä¸ºJavaç¨‹åºçš„åº•å±‚ï¼Œäº†è§£JVMå†…å­˜ç»“æ„å°±æ˜¾å¾—å¾ˆé‡è¦äº†ã€‚æœ‰ä¸€ä¸ªå¾ˆå¸¸è§çš„è¯¯è§£,JVMå†…å­˜ç»“æ„ä¸Javaå†…å­˜æ¨¡å‹åˆ°åº•æŒ‡çš„æ˜¯ä¸æ˜¯åŒä¸€ä¸ªä¸œè¥¿ã€‚å…¶å®ä»–ä»¬ä¸æ˜¯åŒä¸€ä¸ªä¸œè¥¿æ¥çš„ã€‚ï¼ˆä»¥ä¸‹åŸºäºJDK1.8ï¼‰
- JVMå†…å­˜ç»“æ„æŒ‡çš„æ˜¯ä¸€ä¸ªè§„èŒƒï¼Œè§„èŒƒé‡Œé¢è§„å®šäº†JVMå†…å­˜ç»“æ„è¦æœ‰ç±»è£…è½½å­ç³»ç»Ÿã€æ–¹æ³•åŒº,Javaå †ï¼ŒJavaæ ˆã€çº¿ç¨‹è®¡æ•°å™¨ã€æœ¬åœ°æ–¹æ³•æ ˆã€æ‰§è¡Œå¼•æ“ã€‚GCåƒåœ¾å›æ”¶å™¨è¿™äº›ä¸œè¥¿ã€‚è€Œå„ä¸ªä¸åŒJDKåˆ™æ˜¯å®ç°äº†è¿™äº›è§„èŒƒï¼Œä»–ä»¬çš„Javaå†…å­˜æ¨¡å‹,ä¼šæœ‰ä¸€äº›ä¸ä¸€æ ·ã€‚
- ç”¨ä¸€å¼ å›¾è¡¨ç¤ºJVMå†…å­˜ç»“æ„ï¼ˆå›¾1ï¼‰
![JVMå†…å­˜æ¨¡å‹](https://note.youdao.com/yws/api/personal/file/680F798F8D244BF58824F588B75E0A83?method=download&shareKey=96ca1c9d907b4e507331ad92921cf7ee)
- äº†è§£åŸºæœ¬æ¦‚å¿µä¹‹åå¯ä»¥å¼€å§‹çœ‹çœ‹ä¸»æµçš„Javaå†…å­˜æ¨¡å‹æ˜¯é•¿ä»€ä¹ˆæ ·çš„ç”¨ä¸€å¼ å›¾æ¥è¡¨ç¤ºï¼ˆè¿™å¼ å›¾ç”»äº†å¥½ä¹… -- å›¾2ï¼‰
![image](https://note.youdao.com/yws/api/personal/file/35F90A0122F442EDABC1E2A5B5DFDDE0?method=download&shareKey=b8e71533ca46a2b3904a5cf1cfc3973b)
- å£è¯´æ— å‡­ é€šè¿‡ä¸€ä¸ªå°ä¾‹å­çœ‹çœ‹æ ˆæ˜¯æ€ä¹ˆæ‰§è¡Œçš„
```
/**
 * ä¸€æ®µç®€å•çš„ä»£ç  ä¸€çœ‹ä¾¿çŸ¥é“æ‰§è¡Œçš„ç»“æœæ˜¯8
 * é‚£åœ¨è™šæ‹Ÿæœºåº•å±‚è¿™ä¸ª 8 æ˜¯æ€ä¹ˆè®¡ç®—å‡ºæ¥çš„å‘¢
 */
public class MyTest0 {
    public static void main(String[] args) {
        sum();
    }
    static void sum() {
        int a = 5;
        int b = 3;
        System.out.println(a + b);
    }
}
```

åœ¨å½“å‰Javaæ–‡ä»¶çš„ç›®å½•ä¸‹è¾“å…¥ ä»¥ä¸‹æŒ‡ä»¤ç¼–è¯‘æˆMyTest0.classæ–‡ä»¶
> javac MyTest0.java 

è¿™ä¸ªæ—¶å€™ä¼šäº§ç”Ÿä¸€ä¸ªMyTest0.classçš„å­—èŠ‚ç æ–‡ä»¶ï¼Œæˆ‘ä»¬æ˜¯çœ‹ä¸æ‡‚çš„ æˆªå–ä¸€éƒ¨åˆ†å¤§æ¦‚é•¿è¿™æ ·å­ï¼ˆä¸åŒçš„ç¼–ç ç¯å¢ƒä¸‹ æ‰“å¼€ä¼šä¸ä¸€æ ·ï¼‰
```
æ¼±å£•   4 
  
  	  
     <init> ()V Code LineNumberTable main ([Ljava/lang/String;)V sum 
SourceFile 
```
å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤å¯¹classæ–‡ä»¶è¿›è¡Œåç¼–è¯‘ï¼Œåœ¨æ§åˆ¶å°è¾“å‡ºåç¼–è¯‘åçš„ä»£ç 
> javap -c MyTest0

ä¸ºäº†æ–¹ä¾¿ç¼–è¾‘ åœ¨windowç¯å¢ƒä¸‹ä½¿ç”¨ ä»¥ä¸‹æŒ‡ä»¤ å¯ä»¥å°†ç¼–è¯‘åçš„ä»£ç ä¹‹é—´è¾“å‡ºåˆ°MyTest0.txt
> javap -c MyTest0 > MyTest0.txt

ç„¶åç”¨ç¼–è¾‘å™¨æ‰“å¼€ MyTest0.txt é•¿è¿™ä¸ªæ ·å­çš„
å¥½åƒè¿˜æ˜¯çœ‹ä¸æ‡‚hhï¼Œè¿™ä¸ªæ—¶å€™å‘Šè¯‰è‡ªå·±ä¸è¦æ…Œï¼Œè¿™äº›ä¸œè¥¿éœ€è¦ç»“åˆJvmæŒ‡ä»¤é›†ä¸ä¸Šé¢çš„é‚£å¼ å›¾2 ç»“åˆèµ·æ¥è§£æ </br> **PS** ï¼ˆ /--/ å¼€å¤´çš„æ³¨é‡Šæ˜¯æˆ‘è‡ªå·±åŠ çš„è¯´æ˜ï¼‰

```
Compiled from "MyTest0.java"
public class com.dms.MyTest0 {
  public com.dms.MyTest0();
    Code:
       0: aload_0 
       /--/  è°ƒç”¨è¶…ç±»æ„é€ æ–¹æ³•ï¼Œå®ä¾‹åˆå§‹åŒ–æ–¹æ³•ï¼Œç§æœ‰æ–¹æ³• (çœ‹è¿™é‡Œå°±èƒ½æ˜ç™½ä¸ºä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆç±»é‡Œé¢æ²¡æœ‰æ„é€ æ–¹æ³•å´èƒ½newå¯¹å¯¹è±¡ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è°ƒç”¨è¶…ç±»æ„é€ æ–¹æ³•)
       1: invokespecial #1  // Method java/lang/Object."<init>":()V 
       4: return

  public static void main(java.lang.String[]);
    Code:
       0: invokestatic  #2  // Method sum:()V  /--/ è°ƒç”¨é™æ€æ–¹æ³• sum()
       3: return

  static void sum();
    Code:
       0: iconst_5  /--/ å°†intå‹5æ¨é€è‡³sumæ–¹æ³•æ ˆé¡¶
       1: istore_0  /--/ å°†æ ˆé¡¶intå‹æ•°å€¼å­˜å…¥ç¬¬ä¸€ä¸ªæœ¬åœ°å˜é‡(ä¹Ÿå°±æ˜¯å­˜åˆ°sumå±€éƒ¨å˜é‡è¡¨)
       2: iconst_3  /--/ å°†intå‹3æ¨é€è‡³sumæ–¹æ³•æ ˆé¡¶
       3: istore_1  /--/ å°†æ ˆé¡¶intå‹æ•°å€¼å­˜å…¥ç¬¬äºŒä¸ªæœ¬åœ°å˜é‡(ä¹Ÿå°±æ˜¯å­˜åˆ°sumå±€éƒ¨å˜é‡è¡¨)
       /--/ è·å–æŒ‡å®šç±»çš„é™æ€åŸŸï¼Œå¹¶å°†å…¶å€¼å‹å…¥æ ˆé¡¶
       4: getstatic     #3  // Field java/lang/System.out:Ljava/io/PrintStream;
       7: iload_0   /--/ å°†ç¬¬ä¸€ä¸ªintå‹æœ¬åœ°å˜é‡æ¨é€è‡³æ ˆé¡¶(ä¹Ÿå°±æ˜¯æŠŠå±€éƒ¨å˜é‡é‡Œçš„5 æ¨è‡³æ ˆé¡¶)
       8: iload_1   /--/ å°†ç¬¬äºŒä¸ªintå‹æœ¬åœ°å˜é‡æ¨é€è‡³æ ˆé¡¶(ä¹Ÿå°±æ˜¯æŠŠå±€éƒ¨å˜é‡é‡Œçš„3 æ¨è‡³æ ˆé¡¶)
       9: iadd      /--/ å°†æ ˆé¡¶ä¸¤intå‹æ•°å€¼ç›¸åŠ å¹¶å°†ç»“æœå‹å…¥æ ˆé¡¶ ä¹Ÿå°±æ˜¯8
      10: invokevirtual #4  // Method java/io/PrintStream.println:(I)V /--/  è°ƒç”¨å®ä¾‹æ–¹æ³• ä¹Ÿå°±æ˜¯è°ƒç”¨æ‰“å°æ–¹æ³•æŠŠ8æ‰“å°å‡ºæ¥
      13: return    /--/ è¿”å›
}
```
åŸºç¡€æµç¨‹å°±æ˜¯å›¾2ä¸ä»¥ä¸Š /--/ æ³¨é‡Šæ‰€å†™çš„é‚£æ ·å­äº† è‡ªå·±è·Ÿç€æµç¨‹æ“ä½œä¸€éå¯èƒ½ä¼šæ›´å¥½ç†è§£ä¸€äº›ï¼Œæ›´å¤šçš„JVMæŒ‡ä»¤é›†å¯ä»¥å‚è€ƒä»¥ä¸‹é“¾æ¥ï¼Œæˆ–è‡ªè¡Œç½‘ä¸Šæœç´¢
> https://www.cnblogs.com/dreamroute/p/5089513.html

- å›¾äºŒè¯´è¿‡å½“æ–°newå‡ºæ¥çš„å¯¹è±¡å¾ˆå¤§æ—¶è¯¥å¯¹è±¡ä¼šç›´æ¥è¿›å…¥è€å¹´ä»£,ç›´æ¥è·‘æ®µä»£ç çœ‹çœ‹æ˜¯ä¸æ˜¯çœŸçš„æ˜¯è¿™æ ·å­çš„ã€‚
```
public class MyTest {
    /**
     * æ¯ä¸ªå¯¹è±¡æœ‰ä¸€ä¸ª1Mçš„å±æ€§ ä½¿å®ƒä¸€åˆ›å»ºå‡ºæ¥å°±æ˜¯ä¸€ä¸ªå¤§å¯¹è±¡
     */
    byte[] bytes = new byte[1024 * 1000];

    public static void main(String[] args) throws InterruptedException {
        // ç¨‹åºåˆšå¯åŠ¨æ—¶JVMä¼šæœ‰ä¸€äº›åˆå§‹åŒ–çš„å¤„ç†,ä¸ºé¿å…å½±å“å®éªŒç»“æœï¼Œå…ˆç¡çœ 5ç§’
        Thread.sleep(5000);
        // ä¸ºé¿å…åƒåœ¾å›æ”¶æœºåˆ¶è‡ªåŠ¨å›æ”¶æ²¡æœ‰å¼•ç”¨çš„å¯¹è±¡,è¿™é‡Œç”¨ä¸€ä¸ªæ•°ç»„å…ˆè£…ç€ï¼Œä¿è¯å¯¹è±¡å­˜æ´»
        List list = new ArrayList<>();
        // å¾ªç¯æ·»åŠ 1000ä¸ªå¤§å¯¹è±¡
        for (int i = 0; i < 1000; i++) {
            System.out.println(i + "å¼€å§‹æ·»åŠ å¯¹è±¡===");
            Thread.sleep(100);
            list.add(new MyTest());
        }
        
        System.out.println("å¼€å§‹æ¸…ç†åƒåœ¾");
        // å°†å¼•ç”¨ç½®ä¸ºç©º ç„¶åé€šçŸ¥JVMå›æ”¶ç©ºå¯¹è±¡
        list = null;
        System.gc();
        // ç¡çœ ä¸€ä¼š é˜²æ­¢æ‰§è¡Œåƒåœ¾å›æ”¶å‰è™šæ‹Ÿæœºå°±é€€å‡ºäº† 
        Thread.sleep(10000);
    }
}
```
ä»¥ä¸Šä»£ç çš„æ‰§è¡Œç»“æœï¼Œå¿ƒé‡Œé¢„æœŸåº”è¯¥æ˜¯è€å¹´ä»£çš„ç©ºé—´åœ¨1000ä¸ªå¯¹è±¡æ·»åŠ å®Œæˆå‰ä¸€ç›´ä¼šä¿æŒå¢é•¿ï¼Œåœ¨æ·»åŠ å®Œä¸€åƒä¸ªå¯¹è±¡ä¹‹åæ‰§è¡Œåƒåœ¾å›æ”¶ï¼Œç©ºé—´åˆä¼šæ–­å´–å¼çš„ä¸‹è·Œã€‚å£è¯´æ— å‡­ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸ªå·¥å…·è§‚å¯Ÿä¸€ä¸‹è€å¹´ä»£çš„å†…å­˜æƒ…å†µã€‚è¿™é‡Œä½¿ç”¨çš„å·¥å…·æ˜¯JDKå¸¦çš„jconsole
> windowç¯å¢ƒä¸‹ä½¿ç”¨å°é»‘çª—è¾“å…¥jconsole å³å¯è°ƒå‡ºæ¥ é€‰æ‹©æœ¬åœ°è¿›ç¨‹ é€‰æ‹©è‡ªå·±çš„ç¨‹åº
![image](https://note.youdao.com/yws/api/personal/file/8F59626A076C4BFB9F4A729185BBC882?method=download&shareKey=766de2bbfa33eb92e4d378b9cc1ad5b4)


ç„¶åé€‰æ‹©å†…å­˜ å†…å­˜æ± "PS Old Gen" è§‚å¯Ÿè€å¹´ä»£çš„å†…å­˜å˜åŒ– å¯ä»¥çœ‹åˆ°å†…å­˜æ›²çº¿å˜åŒ–æ˜¯ç¬¦åˆå¿ƒç†é¢„æœŸçš„
![image](https://note.youdao.com/yws/api/personal/file/4F1BC047FA94497A81E8D5545FBD7B01?method=download&shareKey=31a3a343d5846a3c60cb7fa9ee49e9e7)